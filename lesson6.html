<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <style>
      * {
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <div id="stats"></div>
    <div id="three"></div>
    <script src="./three.js"></script>
    <script src="./SceneUtils.js"></script>
    <script>
      //设置场景
      const scene = new THREE.Scene();
      //设置相机，这里是设置透视相机，参数分别为（视角，宽高比例，近聚点，远聚点）
      const camera = new THREE.PerspectiveCamera(
        45,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );
      //设置相机的位置
      camera.position.x = -30;
      camera.position.y = 40;
      camera.position.z = 30;
      //让相机指向场景的中央
      camera.lookAt(scene.position);

      //设置绘制对象，基于webGL的渲染器，还有基于canvas和svg等等
      const renderer = new THREE.WebGLRenderer();
      renderer.setClearColor(new THREE.Color(0xeeeeee, 1.0));
      renderer.setSize(window.innerWidth, window.innerHeight);

      //光源，这里使用环境光
      const ambientLight = new THREE.AmbientLight(0x0c0c0c);
      scene.add(ambientLight);

      //光源，这里是点光源
      const spotLight = new THREE.SpotLight(0xffffff);
      //设置点光源的位置
      spotLight.position.set(-40, 60, -10);
      //设置光源可以生产阴影
      spotLight.castShadow = true;
      //把点光源增加到场景中
      scene.add(spotLight);
      //增加雾化效果(颜色，近距离，远距离)
      scene.fog = new THREE.Fog(0xffffff, 0.0005, 100);

      //自定义方块
      //增加8个顶点
      const vertices = [
        new THREE.Vector3(1, 3, 1),
        new THREE.Vector3(1, 3, -1),
        new THREE.Vector3(1, -1, 1),
        new THREE.Vector3(1, -1, -1),
        new THREE.Vector3(-1, 3, -1),
        new THREE.Vector3(-1, 3, 1),
        new THREE.Vector3(-1, -1, -1),
        new THREE.Vector3(-1, -1, 1)
      ];
      //增加6个面
      const faces = [
        new THREE.Face3(0, 2, 1),
        new THREE.Face3(2, 3, 1),
        new THREE.Face3(5, 4, 6),
        new THREE.Face3(6, 7, 5),
        new THREE.Face3(4, 5, 1),
        new THREE.Face3(5, 0, 1),
        new THREE.Face3(7, 6, 2),
        new THREE.Face3(6, 3, 2),
        new THREE.Face3(5, 7, 0),
        new THREE.Face3(7, 2, 0),
        new THREE.Face3(1, 3, 4),
        new THREE.Face3(3, 6, 4)
      ];
      //创建几何体
      const geom = new THREE.Geometry();
      geom.vertices = vertices;
      geom.faces = faces;
      geom.computeFaceNormals();
      //增加材质
      const materials = [
        new THREE.MeshLambertMaterial({
          opacity: 0.9,
          color: 0x44ff44,
          transparent: true
        }),
        new THREE.MeshBasicMaterial({ color: 0x000000, wireframe: true })
      ];
      //构成物体
      const mesh = new THREE.SceneUtils.createMultiMaterialObject(
        geom,
        materials
      );
      mesh.children.forEach(e => {
        e.castShadow = true;
      });

      //网格属性
      //分别移动
      //   mesh.position.x = 10;
      //   mesh.position.y = 20;
      //   mesh.position.z = 1
      //合并移动
      mesh.position.set(10, 2, 1);
      //   mesh.rotation.x = 2;
      //   mesh.rotation.y = 2;
      //   mesh.rotation.z = 2;
      mesh.rotation.set(2, 5, 1);
      mesh.scale.x = 4;

      scene.add(mesh);

      //将renderer的输出挂在到元素中
      document.getElementById("three").appendChild(renderer.domElement);

      renderer.render(scene, camera);
    </script>
  </body>
</html>
